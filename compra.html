<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bisutería Flores</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/nav.css">
    <link rel="stylesheet" href="css/compra.css">
    <link rel="stylesheet" href="css/footer.css">
</head>
<body>

    <nav class="navbar navbar-expand-lg navbar-light bg-light">
             <img src="/Resource/Logo/logo.png" alt="Logo de Bisutería Flores" class="logo">
         <ul class="nav-menu navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item"><a href="index.html" class="active nav-link">Inicio</a></li>
            <li class="nav-item"><a href="index.html" data-translate="Productos" class="nav-link">Productos</a></li>
            <li class="nav-item"><a href="index.html" data-translate="Nosotros" class="nav-link">Nosotros</a></li>
            <li class="nav-item"><a href="index.html" data-translate="Contacto" class="nav-link">Contacto</a></li>
         </ul>
            <div class="nav-cart">
            <span class="cart-icon">🛒</span>
            <span class="cart-count">0</span>
            </div>
        </nav>
    <div class="compra-container container my-5 p-4 bg-white rounded shadow">
        <h2 class="compra-title mb-4">Finalizar Compra</h2>
        <div id="productosSeleccionados"></div>
        <div class="compra-metodo mb-3">
            <label for="metodoPago" class="form-label">Método de pago:</label>
            <select id="metodoPago" class="form-select w-auto d-inline-block">
                <option value="transferencia">Transferencia Bancaria</option>
            </select>
        </div>
        <!-- Formulario de transferencia bancaria con control por voz -->
        <form id="formTransferencia" class="row g-3" style="display: block; margin-top: 20px;">
            <div class="col-md-6">
                <label for="nombreCompleto" class="form-label">Nombre completo:</label>
                <input type="text" id="nombreCompleto" name="nombreCompleto" autocomplete="off" class="form-control">
            </div>
            <div class="col-md-6">
                <label for="dni" class="form-label">DNI:</label>
                <input type="text" id="dni" name="dni" autocomplete="off" class="form-control">
            </div>
            <div class="col-md-6">
                <label for="banco" class="form-label">Banco:</label>
                <input type="text" id="banco" name="banco" autocomplete="off" class="form-control">
            </div>
            <div class="col-md-6">
                <label for="cuenta" class="form-label">Número de cuenta:</label>
                <input type="text" id="cuenta" name="cuenta" autocomplete="off" class="form-control">
            </div>
        </form>
        <button class="compra-btn btn btn-success mt-3" id="realizarPedido">Realizar pedido</button>
        <div class="compra-resumen mt-4" id="compraResumen"></div>
    </div>
    <style>
        .producto-item {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .producto-imagen {
            width: 80px;
            height: 80px;
            object-fit: cover;
            margin-right: 15px;
            border-radius: 4px;
        }

        .producto-info {
            flex: 1;
        }

        .producto-info h3 {
            margin: 0 0 5px 0;
            font-size: 16px;
        }

        .producto-info p {
            margin: 0;
            color: #666;
        }
    </style>
<section id="contacto">
    <footer class="seccion-footer bg-light border-top py-4 mt-5">
        <div class="container d-flex flex-column flex-md-row justify-content-between align-items-center">
            <div class="d-flex align-items-center mb-3 mb-md-0">
                <img src="/Resource/Logo/logo.png" alt="Bisutería Flores" class="me-3" style="height: 78px;">
                <div class="texto-copyright text-muted">
                    <p class="mb-0">&copy; 2025 Bisutería Flores.</p>
                </div>
            </div>
            <div class="bloque-contacto" id="contact-info">
                <h5 class="fw-bold mb-2 text-dark">CONTACTOS:</h5>
                <ul class="list-unstyled mb-0">
                    <li class="mb-1">
                        <i class="bi bi-whatsapp text-success me-1"></i>
                        WhatsApp: <a href="https://wa.link/79t5bz" class="link-primary text-decoration-none">+51 929 162 402</a>
                    </li>
                    <li class="mb-1">
                        <i class="bi bi-envelope-fill text-primary me-1"></i>
                        Email: <a href="mailto:contacto@bisuteriaflores.pe" class="link-primary text-decoration-none">contacto@bisuteriaflores.com</a>
                    </li>
                    <li>
                        <i class="bi bi-geo-alt-fill text-danger me-1"></i>
                        Dirección: Jr. Huallaga Nº 653 - TDA. 109
                    </li>
                </ul>
            </div>
        </div>
    </footer>
    <!-- Bootstrap Icons CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    </section>
    <script>

document.addEventListener('DOMContentLoaded', function() {
    const navLinks = Array.from(document.querySelectorAll('.nav-menu .nav-item a'));
    let navIndex = navLinks.findIndex(link => link.classList.contains('active'));
    if (navIndex === -1) navIndex = 0;
    navLinks[navIndex].focus();
    navLinks[navIndex].classList.add('nav-focused');

    // Función para leer el texto del enlace con voz
    function speak(text) {
        if ('speechSynthesis' in window) {
            window.speechSynthesis.cancel(); // Detener cualquier lectura anterior
            const utter = new SpeechSynthesisUtterance(text);
            utter.lang = 'es-ES';
            window.speechSynthesis.speak(utter);
        }
    }
});
// Función para leer el texto del enlace con voz
function speak(text) {
    if ('speechSynthesis' in window) {
        window.speechSynthesis.cancel(); // Detener cualquier lectura anterior
        const utter = new SpeechSynthesisUtterance(text);
        utter.lang = 'es-ES';
        window.speechSynthesis.speak(utter);
    }
}

document.addEventListener('DOMContentLoaded', function() {
    const navLinks = Array.from(document.querySelectorAll('.nav-menu .nav-item a'));
    let navIndex = navLinks.findIndex(link => link.classList.contains('active'));
    if (navIndex === -1) navIndex = 0;
    navLinks[navIndex].focus();
    navLinks[navIndex].classList.add('nav-focused');
});
        document.addEventListener('keydown', function(event) {
    const navLinks = Array.from(document.querySelectorAll('.nav-menu .nav-item a'));
    let currentIndex = navLinks.findIndex(link => link.classList.contains('nav-focused'));

    switch(event.key) {
        case 'ArrowDown':
            event.preventDefault();
            navLinks[currentIndex]?.classList.remove('nav-focused');
            currentIndex = (currentIndex + 1) % navLinks.length;
            navLinks[currentIndex].classList.add('nav-focused');
            navLinks[currentIndex].focus();
            speak(navLinks[currentIndex].textContent);
            break;
            
        case 'ArrowUp':
            event.preventDefault();
            navLinks[currentIndex]?.classList.remove('nav-focused');
            currentIndex = (currentIndex - 1 + navLinks.length) % navLinks.length;
            navLinks[currentIndex].classList.add('nav-focused');
            navLinks[currentIndex].focus();
            speak(navLinks[currentIndex].textContent);
            break;
    }
});
        // Limpiar el carrito al regresar a la página anterior
        window.onbeforeunload = function() {
            localStorage.removeItem('cartItems');
        };
        
        // Función para mostrar los productos seleccionados
        function mostrarProductos() {
            const cartItems = JSON.parse(localStorage.getItem('cartItems')) || [];
            const productosDiv = document.getElementById('productosSeleccionados');
            
            productosDiv.innerHTML = '';
            
            cartItems.forEach(product => {
                const productoHTML = `
                    <div class="producto-item">
                        <img src="${product.image}" alt="${product.name}" class="producto-imagen">
                        <div class="producto-info">
                            <h3>${product.name}</h3>
                            <p>${product.description}</p>
                            <p class="precio">${product.price}</p>
                        </div>
                    </div>
                `;
                productosDiv.innerHTML += productoHTML;
            });
        }

        // Llamar a la función cuando se carga la página
        document.addEventListener('DOMContentLoaded', mostrarProductos);

    
// Manejar el evento click del botón "Realizar pedido"
document.getElementById('realizarPedido').addEventListener('click', function() {
    const metodoPago = document.getElementById('metodoPago').value;
    const cartItems = JSON.parse(localStorage.getItem('cartItems')) || [];
    const resumenDiv = document.getElementById('compraResumen');
    let total = 0;

    cartItems.forEach(product => {
        const precioStr = product.price.replace('S/', '').trim();
        const precio = parseFloat(precioStr) || 0;
        total += precio;
    });

    resumenDiv.innerHTML = `
        <p>Método de pago: ${metodoPago}</p>
        <p>Total a pagar: S/ ${total.toFixed(2)}</p>
        <p>¡Gracias por tu compra!</p>
    `;

    // Leer el resumen de la compra con voz y esperar a que termine antes de redirigir
    const mensaje = `Método de pago: ${metodoPago}. Total a pagar: ${total.toFixed(2)} soles. ¡Gracias por tu compra!`;
    const utter = new SpeechSynthesisUtterance(mensaje);
    utter.lang = 'es-ES';
    window.speechSynthesis.cancel();
    window.speechSynthesis.speak(utter);
    utter.onend = function() {
        // Limpiar el carrito después de la compra y redirigir
        localStorage.removeItem('cartItems');
        setTimeout(() => {
            window.location.href = 'index.html';
        }, 1000); // 1 segundo después de la voz
    };
});
        // --- INICIO: Navegación manual por campos del formulario con barra espaciadora ---
const camposForm = [
    { id: 'nombreCompleto', label: 'Nombre ' },
    { id: 'dni', label: 'DNI' },
    { id: 'banco', label: 'Banco' },
    { id: 'cuenta', label: 'Número de cuenta' },
];

function focusSiguienteCampo(actualId) {
    const idx = camposForm.findIndex(c => c.id === actualId);
    if (idx !== -1 && idx < camposForm.length - 1) {
        const siguiente = document.getElementById(camposForm[idx + 1].id);
        if (siguiente) {
            siguiente.focus();
            // Al enfocar, leer "Complete el campo ..."
            speak('Complete el campo ' + camposForm[idx + 1].label + '.');
        }
    } else if (idx === camposForm.length - 1) {
        speak('Todos los campos completados. Presione el botón Realizar pedido para finalizar la compra.');
    }
}

window.addEventListener('DOMContentLoaded', function() {
    camposForm.forEach(campo => {
        const input = document.getElementById(campo.id);
        if (input) {
            input.addEventListener('focus', function() {
                speak('Complete el campo ' + campo.label + '.');
            });
            // Doble espacio para avanzar
            let lastSpaceTime = 0;
            input.addEventListener('input', function() {
                if (input.value.trim() !== '') {
                    speak('Pulse la tecla espacio dos veces para ir al siguiente campo.');
                }
            });
            input.addEventListener('keydown', function(e) {
                if (e.code === 'Space' || e.key === ' ') {
                    const now = Date.now();
                    if (now - lastSpaceTime < 400) { // 400ms para doble espacio
                        e.preventDefault();
                        if (input.value.trim() !== '') {
                            const idx = camposForm.findIndex(c => c.id === campo.id);
                            if (idx !== -1 && idx < camposForm.length - 1) {
                                const utter = new SpeechSynthesisUtterance('Avanzando al siguiente campo.');
                                utter.lang = 'es-ES';
                                utter.onend = function() {
                                    focusSiguienteCampo(campo.id);
                                };
                                window.speechSynthesis.cancel();
                                window.speechSynthesis.speak(utter);
                            } else if (idx === camposForm.length - 1) {
                                // Al completar el último campo, realizar pedido automáticamente
                                const utter = new SpeechSynthesisUtterance('Todos los campos completados. Procesando su pedido.');
                                utter.lang = 'es-ES';
                                utter.onend = function() {
                                    document.getElementById('realizarPedido').click();
                                };
                                window.speechSynthesis.cancel();
                                window.speechSynthesis.speak(utter);
                            }
                        } else {
                            focusSiguienteCampo(campo.id);
                        }
                        lastSpaceTime = 0; // reset
                    } else {
                        lastSpaceTime = now;
                    }
                }
            });
        }
    });
    // Dar focus al primer campo al cargar
    const primerCampo = document.getElementById('nombreCompleto');
    if (primerCampo) {
        primerCampo.focus();
    }
    // Eliminar el focus automático al primer campo
});
        // --- FIN: Navegación manual por campos del formulario ---
        </script>
    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
